package com.rest;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStreamReader;
import java.util.HashMap;
import java.util.Map;

import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.junit.Test;

import io.restassured.RestAssured;
import io.restassured.http.Method;
import io.restassured.response.Response;
import io.restassured.specification.RequestSpecification;

public class Example {

	@Test
	public void GetWeatherDetails() {
		//RestAssured.baseURI = "https://http-hunt.thoughtworks-labs.net/challenge/input";
		
		RestAssured.baseURI = "https://http-hunt.thoughtworks-labs.net/challenge/input";

		RequestSpecification httpRequest = RestAssured.given();
		httpRequest.header("userId", "Q-_hTQIU");

		Response response = httpRequest.request(Method.GET);

		String responseBody = response.getBody().asString();
		
		System.out.println(responseBody);
		
		System.out.println(response.jsonPath().getString("text").split("\\s+").length);

		//Map<String, Map<String, String>> input = response.jsonPath().getMap("sampleInput");

		//HashMap<String, String> temp = (HashMap<String, String>) input.get("input");
		
		//System.out.println(temp.get("text"));
		
		//System.out.println(temp.get("text").split("\\s+").length);

		RestAssured.baseURI = "https://http-hunt.thoughtworks-labs.net/challenge/output";
		RequestSpecification request = RestAssured.given();

		request.header("content-type", "application/json");
		request.header("userId", "Q-_hTQIU");

		JSONObject requestParams = new JSONObject();
		requestParams.put("wordCount", response.jsonPath().getString("text").split("\\s+").length);
		
		
		
		//requestParams.put("count", temp.get("text").length()); // Cast

		//JSONArray array = new JSONArray();
		//array.add(requestParams);

		//JSONObject mainObj = new JSONObject();
		//mainObj.put("output", array);

		request.body(requestParams.toJSONString());
		Response response1 = request.post();

		int statusCode = response1.getStatusCode();
		System.out.println("The status code recieved: " + statusCode);

		 //System.out.println("Response body: " + response1.body().asString());

	}

	/*
	 * public static void getcharcterCount() throws IOException { File file =
	 * new File("a.txt"); FileInputStream fileStream = new
	 * FileInputStream(file); InputStreamReader input = new
	 * InputStreamReader(fileStream); BufferedReader reader = new
	 * BufferedReader(input);
	 * 
	 * String line;
	 * 
	 * // Initializing counters int countWord = 0; int sentenceCount = 0; int
	 * characterCount = 0; int paragraphCount = 1; int whitespaceCount = 0;
	 * 
	 * // Reading line by line from the // file until a null is returned
	 * while((line = reader.readLine()) != null) { if(line.equals("")) {
	 * paragraphCount++; } if(!(line.equals(""))) {
	 * 
	 * characterCount += line.length();
	 * 
	 * // \\s+ is the space delimiter in java String[] wordList =
	 * line.split("\\s+");
	 * 
	 * countWord += wordList.length; whitespaceCount += countWord -1;
	 * 
	 * // [!?.:]+ is the sentence delimiter in java String[] sentenceList =
	 * line.split("[!?.:]+");
	 * 
	 * sentenceCount += sentenceList.length; } }
	 * 
	 * System.out.println("Total word count = " + countWord);
	 * System.out.println("Total number of sentences = " + sentenceCount);
	 * System.out.println("Total number of characters = " + characterCount);
	 * System.out.println("Number of paragraphs = " + paragraphCount);
	 * System.out.println("Total number of whitespaces = " + whitespaceCount); }
	 */

}